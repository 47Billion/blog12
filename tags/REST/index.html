<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Tag: REST | 47Billion Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="47Billion Blog">
<meta property="og:url" content="http://47billion.com/blog/blog/tags/REST/">
<meta property="og:site_name" content="47Billion Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="47Billion Blog">
<meta name="twitter:description">

  
  
    <link rel="icon" href="/favicon.png">
  
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <!--<link href="//fonts.useso.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">-->
  <!--<link href='//fonts.useso.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css'>-->
  <link rel="stylesheet" href="/blog/css/style.css" type="text/css">

  <link rel="stylesheet" href="/blog/css/slicknav.css" type="text/css">

  
<!-- Google Analytics -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60258456-2', 'auto');
    ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <a href="http://www.47billion.com/" class="logo">47Billion Blog</a>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
          
      </nav>


      <nav id="sub-nav">
          <div id="search-form-wrap">
              <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://47billion.com/blog"></form>
          </div>
          <a id="nav-search-btn" class="nav-icon" title="Search"></a>
          <div class="headsociallink">
              <a href="https://www.facebook.com/47Billion" target="_blank"><i class="fa fa-facebook-square"></i></a>
              <a href="https://twitter.com/47billion" target="_blank"><i class="fa fa-twitter-square"></i></a>
              <a href="https://www.linkedin.com/company/47billion" target="_blank"><i class="fa fa-linkedin-square"></i></a>
              <a href="https://plus.google.com/102587598432325227811"><i class="fa fa-google-plus-square"></i></a>
              <a href="mailto:info@47billion.com"><i class="fa fa-envelope"></i></a>
          </div>
      </nav>
    </div>
  </div>
</header>

      <nav id="mobile-nav" class="off">
  
  <div id="search-form-wrap-mobile">
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://47billion.com/blog"></form>
  </div>
</nav>
      <div class="outer">
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Digital-World/">Digital World</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Technology/">Technology</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Technology/Java/">Java</a><span class="category-list-count">1</span></li></ul></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/07/">July 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/02/">February 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2013/09/">September 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2013/01/">January 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2012/03/">March 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2011/09/">September 2011</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Aspect-Oriented-Programming/">Aspect Oriented Programming</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/AspectJ/">AspectJ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Delayed-Job/">Delayed Job</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Deployable/">Deployable</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Design-Pattern/">Design Pattern</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Digital-Signage/">Digital Signage</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Embedded-Jetty/">Embedded Jetty</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Guice/">Guice</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/JAX-RS/">JAX-RS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Java/">Java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Java-Annotation/">Java Annotation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/JavaScript/">JavaScript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Jersey/">Jersey</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Jesque/">Jesque</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Jetty/">Jetty</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Python/">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Quartz/">Quartz</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/REST/">REST</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Redis/">Redis</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Resque/">Resque</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Resteasy/">Resteasy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Security/">Security</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Spring/">Spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/jsr250/">jsr250</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
        
        <section id="main">
  
    <article id="post-jetty-executable-webserver-archetype" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/01/08/jetty-executable-webserver-archetype/" class="article-date">
  <time datetime="2013-01-08T08:18:49.000Z" itemprop="datePublished">Jan 8 2013</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/01/08/jetty-executable-webserver-archetype/">Jetty Executable Webserver Archetype</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>We create and deploy many rest based API apps on our servers. Now, instead of managing multitudes of webservers on different machines, we make our deployable archives wrapped with all the necessary dependencies in order to be self-executable. Benefits?</p>
<ul>
<li>We just have to ensure that all our servers have the same Java environment, and no other dependencies.</li>
<li>No waste of time configuring, managing web (tomcat, jetty etc.) servers.</li>
<li>And, we only have to distribute a single executable.<br>Hassle free management. Won’t you agree?</li>
</ul>
<p>To cut down on bootstrapping time, we have created a <a href="http://maven.apache.org/guides/introduction/introduction-to-archetypes.html" target="_blank" rel="external">maven archetype</a> to help us quickly create and start on new API projects. Our tech stack is <a href="http://code.google.com/p/google-guice/" target="_blank" rel="external">Google Guice</a>, <a href="http://www.jboss.org/resteasy" target="_blank" rel="external">JBoss Resteasy</a>, <a href="http://logback.qos.ch/" target="_blank" rel="external">Logback</a>, and <a href="http://www.eclipse.org/jetty/" target="_blank" rel="external">Embedded Jetty</a>.</p>
<p>Github link: <a href="https://github.com/anismiles/jetty-webserver-archetype" target="_blank" rel="external">https://github.com/anismiles/jetty-webserver-archetype</a></p>
<h2 id="Install">Install</h2>
<p>You can either build/install from source</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git clone https:<span class="comment">//github.com/anismiles/jetty-webserver-archetype.git</span></div><div class="line">mvn clean install</div></pre></td></tr></table></figure>

<p>Or you can simply <a href="https://github.com/anismiles/jetty-webserver-archetype/blob/master/downloads/jetty-webserver-archetype-1.0.jar?raw=true" target="_blank" rel="external">download the jar</a> and install that.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mvn install:install-file \</div><div class="line">-Dfile=jetty-webserver-archetype-<span class="number">1.0</span>.jar \</div><div class="line">-DgroupId=com.strumsoft \</div><div class="line">-DartifactId=jetty-webserver-archetype \</div><div class="line">-Dversion=<span class="number">1.0</span> \</div><div class="line">-Dpackaging=jar \</div><div class="line">-DgeneratePom=<span class="keyword">true</span></div></pre></td></tr></table></figure>

<h2 id="Usage">Usage</h2>
<p>Let’s say you want to create a new project “<strong>hello-world</strong>” with group “<strong>com.hello.world</strong>”, you would run:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mvn archetype:generate \</div><div class="line">-DgroupId=com.hello.world \</div><div class="line">-DartifactId=hello-world \</div><div class="line">-Dversion=<span class="number">1.0</span>-SNAPSHOT \</div><div class="line">-DarchetypeGroupId=com.strumsoft \</div><div class="line">-DarchetypeVersion=<span class="number">1.0</span> \</div><div class="line">-DarchetypeArtifactId=jetty-webserver-archetype</div></pre></td></tr></table></figure>

<p>That’s it. You are ready to roll. You have set up a basic working API app. Now, you can run it in dev mode</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn clean jetty:run</div></pre></td></tr></table></figure>

<p>Or in production mode</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mvn clean <span class="keyword">package</span></div><div class="line">java –jar target/hello-world-<span class="number">1.0</span>-SNAPSHOT-dist.war start &amp;</div></pre></td></tr></table></figure>

<p>To check, open <a href="http://localhost:8085/" target="_blank" rel="external">http://localhost:8085/</a><br>To stop:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java –jar target/hello-world-<span class="number">1.0</span>-SNAPSHOT-dist.war stop</div></pre></td></tr></table></figure>

<p>Further, you can pass additional Jetty, Logback or your App’s properties</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">java \</div><div class="line">-Djetty.configurationFile=&lt;jetty-config&gt; \</div><div class="line">-Dapp.configurationFile=&lt;app.properties&gt; \</div><div class="line">-Dlogback.configurationFile=&lt;logback.xml&gt; \</div><div class="line">–jar target/hello-world-<span class="number">1.0</span>-SNAPSHOT-dist.war start &amp;</div></pre></td></tr></table></figure>

<p>They will override default properties setup by the executable.<br>Ideally you might want to create an <a href="http://www.ghacks.net/2009/04/04/get-to-know-linux-the-etcinitd-directory/" target="_blank" rel="external">init.d</a> file to start and stop you API app efficiently. Here is a prototype:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/sh</span></div><div class="line"></div><div class="line"><span class="comment"># Executable war file</span></div><div class="line">WAR_FILE=/var/apps/&lt;my-war-file&gt;.war</div><div class="line"></div><div class="line"><span class="comment"># Configuration files</span></div><div class="line">APP_NAME=&lt;app-name&gt;</div><div class="line"></div><div class="line">JETTY_CONFIG=/etc/<span class="variable">${APP_NAME}</span>-jetty.properties</div><div class="line">APP_CONFIG=/etc/<span class="variable">${APP_NAME}</span>-app.properties</div><div class="line">LOGBACK_CONFIG=/etc/<span class="variable">${APP_NAME}</span>-logback.properties</div><div class="line"></div><div class="line"><span class="comment"># Process</span></div><div class="line">PIDFILE=/var/run/<span class="variable">${APP_NAME}</span>.pid</div><div class="line"></div><div class="line"><span class="comment"># Java arguments</span></div><div class="line">JAVA_ARGS=&quot;-Djetty.configurationFile=<span class="variable">${JETTY_CONFIG}</span> -Dapp.configurationFile=<span class="variable">${APP_CONFIG}</span> -Dlogback.configurationFile=<span class="variable">${LOGBACK_CONFIG}</span>&quot;</div><div class="line"></div><div class="line"><span class="comment"># Command</span></div><div class="line">CMD=<span class="variable">$1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [[ -z <span class="variable">${CMD}</span> ]]; <span class="keyword">then</span></div><div class="line">  java <span class="variable">${JAVA_ARGS}</span> -jar <span class="variable">${WAR_FILE}</span> usage</div><div class="line">  <span class="keyword">exit</span> <span class="number">1</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [[ <span class="variable">${CMD}</span> == <span class="string">'start'</span> ]]; <span class="keyword">then</span></div><div class="line">    <span class="keyword">if</span> [[ <span class="operator">-f</span> <span class="variable">${PIDFILE}</span> ]]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">echo</span> &quot;Already running&quot;</div><div class="line">        <span class="keyword">exit</span> <span class="number">1</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> [[ <span class="operator">-f</span> <span class="variable">${WAR_FILE}</span> ]]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">echo</span> &quot;Starting jetty: <span class="variable">${WAR_FILE}</span>&quot;</div><div class="line">        java <span class="variable">${JAVA_ARGS}</span> -jar <span class="variable">${WAR_FILE}</span> start &amp;</div><div class="line">        PID=$!</div><div class="line">        <span class="built_in">echo</span> &quot;<span class="variable">$PID</span>&quot; &gt; <span class="variable">${PIDFILE}</span></div><div class="line">        <span class="built_in">echo</span> &quot;Started <span class="variable">${APP_NAME}</span> with pid: <span class="variable">${PID}</span>&quot;</div><div class="line">    <span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="keyword">elif</span> [[ <span class="variable">${CMD}</span> == <span class="string">'stop'</span> ]]; <span class="keyword">then</span></div><div class="line">    <span class="comment"># Try gracefully first</span></div><div class="line">    java <span class="variable">${JAVA_ARGS}</span> -jar <span class="variable">${WAR_FILE}</span> stop</div><div class="line">    sleep <span class="number">10</span></div><div class="line">    <span class="keyword">if</span> [[ <span class="operator">-f</span> <span class="variable">${PIDFILE}</span> ]]; <span class="keyword">then</span></div><div class="line">        PID=`cat <span class="variable">${PIDFILE}</span>`</div><div class="line">        test -z <span class="variable">$PID</span> || kill <span class="variable">$PID</span></div><div class="line">        rm <span class="variable">${PIDFILE}</span></div><div class="line">        sleep <span class="number">1</span></div><div class="line">        <span class="built_in">echo</span> &quot;Forcibly Stopped <span class="variable">${WAR_FILE}</span> with pid: <span class="variable">${PID}</span>&quot;</div><div class="line">    <span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="keyword">else</span> <span class="comment"># Just let the other cmds through...</span></div><div class="line">    java <span class="variable">${JAVA_ARGS}</span> -jar <span class="variable">${WAR_FILE}</span> <span class="variable">${CMD}</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="keyword">exit</span> <span class="number">0</span></div></pre></td></tr></table></figure>

<p>That’s it! have fun. :)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://47billion.com/blog/2013/01/08/jetty-executable-webserver-archetype/" data-id="mp0n9zw9gnudm77k" class="article-share-link">Share</a>
      
        <a href="http://47billion.com/blog/2013/01/08/jetty-executable-webserver-archetype/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Deployable/">Deployable</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Embedded-Jetty/">Embedded Jetty</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Guice/">Guice</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Jetty/">Jetty</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/REST/">REST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Resteasy/">Resteasy</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-securing-versioning-and-auditing-rest-jax-rs-jersey-apis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/03/02/securing-versioning-and-auditing-rest-jax-rs-jersey-apis/" class="article-date">
  <time datetime="2012-03-02T13:49:33.000Z" itemprop="datePublished">Mar 2 2012</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/03/02/securing-versioning-and-auditing-rest-jax-rs-jersey-apis/">Securing, Versioning and Auditing REST (JAX-RS, Jersey) APIs</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Now that your functionalities are working, you want a layer of security to authenticate/authorize your APIs. Though this is a bad approach towards security, but – I know – real life is a tough game and nothing happens they way they should be… and so be it. Additionally, you might want to control API versions (i.e. expose newer APIs only to newer clients) and audit API usage.</p>
<p>Well, I am going to propose a <em>tangential</em> way to implement these concerns. You won’t need to touch any of your business logic as such. Only few annotations (custom and otherwise) would need to be applied. That way, you won’t feel bad about missing these things when you started the project and your concerns will be taken care of in the most un-obtrusive way possible. Wonderful… eh?</p>
<p>First, you will need to create some sort of <strong>sign-in</strong> API, which will accept username/password (or oAuth or whatever you fancy) and generate some sort of session information which you will store in some database (<a href="http://redis.io/" target="_blank" rel="external">Redis</a> maybe!) and share its ID, say <em>sessionId</em>, with client. Then, with every subsequent request, Client will attach this sessionId in the request header which server will pick and look up for associated session information (permission, roles etc.) and based upon that server will authenticate and authorize the request. </p>
<p>Here is your Session bean.  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.strumsoft.api;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.Serializable;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> *<span class="javadoctag"> @author</span> &quot;Animesh Kumar &lt;animesh@strumsoft.com&gt;&quot;</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Session</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>{</div><div class="line">	<span class="comment">// </span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">7483170872690892182</span>L;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> String sessionId;   <span class="comment">// id</span></div><div class="line">	<span class="keyword">private</span> String userId;      <span class="comment">// user</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> active;     <span class="comment">// session active?</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> secure;     <span class="comment">// session secure?</span></div><div class="line"></div><div class="line">	<span class="keyword">private</span> Date createTime;    <span class="comment">// session create time</span></div><div class="line">	<span class="keyword">private</span> Date lastAccessedTime;  <span class="comment">// session last use time</span></div><div class="line"></div><div class="line">	<span class="comment">// getters/setters here</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>And this is your User bean. This must implement <a href="http://docs.oracle.com/javase/6/docs/api/java/security/Principal.html" target="_blank" rel="external">java.security.Principal</a>. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.strumsoft.api;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Set;</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> *<span class="javadoctag"> @author</span> &quot;Animesh Kumar &lt;animesh@strumsoft.com&gt;&quot;</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">security</span>.<span class="title">Principal</span> </span>{</div><div class="line">	<span class="comment">// Role</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">enum</span> Role {</div><div class="line">		Editor, Visitor, Contributor</div><div class="line">	};</div><div class="line"></div><div class="line">	<span class="keyword">private</span> String userId;          <span class="comment">// id</span></div><div class="line">	<span class="keyword">private</span> String name;            <span class="comment">// name</span></div><div class="line">	<span class="keyword">private</span> String emailAddress;    <span class="comment">// email</span></div><div class="line">	<span class="keyword">private</span> Set&lt;Role&gt; roles;        <span class="comment">// roles</span></div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> String <span class="title">getName</span>() {</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="comment">// getters/setters here</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>Now, you need to implement <a href="http://jackson.codehaus.org/javadoc/jax-rs/1.0/javax/ws/rs/core/SecurityContext.html" target="_blank" rel="external">javax.ws.rs.core.SecurityContext</a>. This will be bound to incoming request and will decide whether to allow or deny it.  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.strumsoft.api;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.security.Principal;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.WebApplicationException;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.core.Response;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.core.SecurityContext;</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> *<span class="javadoctag"> @author</span> &quot;Animesh Kumar &lt;animesh@strumsoft.com&gt;&quot;</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySecurityContext</span> <span class="keyword">implements</span> <span class="title">javax</span>.<span class="title">ws</span>.<span class="title">rs</span>.<span class="title">core</span>.<span class="title">SecurityContext</span> </span>{</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> User user;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> Session session;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="title">MySecurityContext</span>(Session session, User user) {</div><div class="line">		<span class="keyword">this</span>.session = session;</div><div class="line">		<span class="keyword">this</span>.user = user;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> String <span class="title">getAuthenticationScheme</span>() {</div><div class="line">		<span class="keyword">return</span> SecurityContext.BASIC_AUTH;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> Principal <span class="title">getUserPrincipal</span>() {</div><div class="line">		<span class="keyword">return</span> user;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSecure</span>() {</div><div class="line">		<span class="keyword">return</span> (<span class="keyword">null</span> != session) ? session.isSecure() : <span class="keyword">false</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUserInRole</span>(String role) {</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == session || !session.isActive()) {</div><div class="line">			<span class="comment">// Forbidden</span></div><div class="line">			Response denied = Response.status(Response.Status.FORBIDDEN).entity(&quot;Permission Denied&quot;).build();</div><div class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WebApplicationException(denied);</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="keyword">try</span> {</div><div class="line">			<span class="comment">// this user has this role?</span></div><div class="line">			<span class="keyword">return</span> user.getRoles().contains(User.Role.valueOf(role));</div><div class="line">		} <span class="keyword">catch</span> (Exception e) {</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>Then, you need a <a href="http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/spi/container/ResourceFilter.html" target="_blank" rel="external">ResourceFilter</a> which will intercept the request, look for sessionId in the header and generate and attach our SecurityContext implementation to it. Notice, how our implementation only gets applied on Request but not on Response. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.strumsoft.api;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.ws.rs.ext.Provider;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</div><div class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.flockthere.api.repository.SessionRepository;</div><div class="line"><span class="keyword">import</span> com.flockthere.api.repository.UserRepository;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.spi.container.ContainerRequest;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.spi.container.ContainerRequestFilter;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.spi.container.ContainerResponseFilter;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.spi.container.ResourceFilter;</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> * Filter all incoming requests, look for possible session information and use that</div><div class="line"> * to create and load a SecurityContext to request. </div><div class="line"> *<span class="javadoctag"> @author</span> &quot;Animesh Kumar &lt;animesh@strumsoft.com&gt;&quot;</div><div class="line"> * </div><div class="line"> */</div><div class="line"><span class="annotation">@Component</span>   <span class="comment">// let spring manage the lifecycle</span></div><div class="line"><span class="annotation">@Provider</span>    <span class="comment">// register as jersey's provider</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityContextFilter</span> <span class="keyword">implements</span> <span class="title">ResourceFilter</span>, <span class="title">ContainerRequestFilter</span> </span>{</div><div class="line"></div><div class="line">	<span class="annotation">@Autowired</span></div><div class="line">	<span class="keyword">private</span> SessionRepository sessionRepository;  <span class="comment">// DAO to access Session</span></div><div class="line"></div><div class="line">	<span class="annotation">@Autowired</span></div><div class="line">	<span class="keyword">private</span> UserRepository userRepository;  <span class="comment">// DAO to access User</span></div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> ContainerRequest <span class="title">filter</span>(ContainerRequest request) {</div><div class="line">		<span class="comment">// Get session id from request header</span></div><div class="line">		<span class="keyword">final</span> String sessionId = request.getHeaderValue(&quot;session-id&quot;);</div><div class="line"></div><div class="line">		User user = <span class="keyword">null</span>;</div><div class="line">		Session session = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (sessionId != <span class="keyword">null</span> &amp;&amp; sessionId.length() &gt; <span class="number">0</span>) {</div><div class="line">			<span class="comment">// Load session object from repository</span></div><div class="line">			session = sessionRepository.findOne(sessionId);</div><div class="line"></div><div class="line">			<span class="comment">// Load associated user from session</span></div><div class="line">			<span class="keyword">if</span> (<span class="keyword">null</span> != session) {</div><div class="line">				user = userRepository.findOne(session.getUserId());</div><div class="line">			}</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="comment">// Set security context</span></div><div class="line">		request.setSecurityContext(<span class="keyword">new</span> MySecurityContext(session, user));</div><div class="line">		<span class="keyword">return</span> request;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> ContainerRequestFilter <span class="title">getRequestFilter</span>() {</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> ContainerResponseFilter <span class="title">getResponseFilter</span>() {</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>Okay, the hard part is over. All we need now is a way to fire our SecurityContextFilter. For this, we will create a <a href="http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/spi/container/ResourceFilterFactory.html" target="_blank" rel="external">ResourceFilterFactory</a>. During application startup, this factory will create a List of filters for all <a href="http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/model/AbstractMethod.html" target="_blank" rel="external">AbstractMethod</a>s of each of our Resources. We are going to extend <a href="http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/container/filter/RolesAllowedResourceFilterFactory.html" target="_blank" rel="external">RolesAllowedResourceFilterFactory</a> which will generate all Role based ResourceFilters for us. And then, we will add our SecurityContextFilter on the top of the list with VersionFilter and AuditFilter in the bottom. That way, SecurityContextFilter will executed first because you need to make auth decisions early. VersionFilter will be next. And Audit in the bottom. You want to audit when everything else has been done. No? </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.strumsoft.api;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.ws.rs.ext.Provider;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</div><div class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.flockthere.api.AllowAllVersions;</div><div class="line"><span class="keyword">import</span> com.flockthere.api.audit.Audit;</div><div class="line"><span class="keyword">import</span> com.flockthere.api.resource.interceptor.AuditingFilter;</div><div class="line"><span class="keyword">import</span> com.flockthere.api.resource.interceptor.SecurityContextFilter;</div><div class="line"><span class="keyword">import</span> com.flockthere.api.resource.interceptor.VersionFilter;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.api.container.filter.RolesAllowedResourceFilterFactory;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.api.model.AbstractMethod;</div><div class="line"><span class="keyword">import</span> com.sun.jersey.spi.container.ResourceFilter;</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> * FilterFactory to create List of request/response filters to be applied on a particular</div><div class="line"> * AbstractMethod of a resource.</div><div class="line"> * </div><div class="line"> *<span class="javadoctag"> @author</span> &quot;Animesh Kumar &lt;animesh@strumsoft.com&gt;&quot;</div><div class="line"> * </div><div class="line"> */</div><div class="line"><span class="annotation">@Component</span> <span class="comment">// let spring manage the lifecycle</span></div><div class="line"><span class="annotation">@Provider</span>  <span class="comment">// register as jersey's provider</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResourceFilterFactory</span> <span class="keyword">extends</span> <span class="title">RolesAllowedResourceFilterFactory</span> </span>{</div><div class="line"></div><div class="line">	<span class="annotation">@Autowired</span></div><div class="line">	<span class="keyword">private</span> SecurityContextFilter securityContextFilter;</div><div class="line"></div><div class="line">	<span class="comment">// Similar to SecurityContextFilter to check incoming requests for API Version information and</span></div><div class="line">	<span class="comment">// act accordingly</span></div><div class="line">	<span class="annotation">@Autowired</span></div><div class="line">	<span class="keyword">private</span> VersionFilter versionFilter;</div><div class="line"></div><div class="line">	<span class="comment">// Similar to SecurityContextFilter to audit incoming requests</span></div><div class="line">	<span class="annotation">@Autowired</span></div><div class="line">	<span class="keyword">private</span> AuditingFilter auditingFilter;</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> List&lt;ResourceFilter&gt; create(AbstractMethod am) {</div><div class="line">		<span class="comment">// get filters from RolesAllowedResourceFilterFactory Factory!</span></div><div class="line">		List&lt;ResourceFilter&gt; rolesFilters = <span class="keyword">super</span>.create(am);</div><div class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == rolesFilters) {</div><div class="line">			rolesFilters = <span class="keyword">new</span> ArrayList&lt;ResourceFilter&gt;();</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="comment">// Convert into mutable List, so as to add more filters that we need</span></div><div class="line">		<span class="comment">// (RolesAllowedResourceFilterFactory generates immutable list of filters)</span></div><div class="line">		List&lt;ResourceFilter&gt; filters = <span class="keyword">new</span> ArrayList&lt;ResourceFilter&gt;(rolesFilters);</div><div class="line"></div><div class="line">		<span class="comment">// Load SecurityContext first (this will load security context onto request)</span></div><div class="line">		filters.add(<span class="number">0</span>, securityContextFilter);</div><div class="line"></div><div class="line">		<span class="comment">// Version Control?</span></div><div class="line">		filters.add(versionFilter);</div><div class="line"></div><div class="line">		<span class="comment">// If this abstract method is annotated with @Audit, we will apply AuditFilter to audit</span></div><div class="line">		<span class="comment">// this request.</span></div><div class="line">		<span class="keyword">if</span> (am.isAnnotationPresent(Audit.class)) {</div><div class="line">			filters.add(auditingFilter);</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="keyword">return</span> filters;</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>VersionFilter will help control Client’s access to API methods based upon client’s version. Implementation would be similar to SecurityContextFilter. You will need to annotate API methods with @Version(“&gt;1.3”). VersionFilter will read this value (“&gt;1.3”), check request headers for API-Version keys and then decide whether to allow or reject the request. Similarly, AuditFilter will log all such annotated (@Audit(“audit-note”)) API methods. I will not discuss their actual implementations. You can very easily write them based upon your requirement or can remove them altogether if not needed. </p>
<p>Here is how these annotations will look like. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// @Version</span></div><div class="line"><span class="annotation">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class="line"><span class="annotation">@Target</span>({ ElementType.METHOD })</div><div class="line"><span class="keyword">public</span> @<span class="class"><span class="keyword">interface</span> <span class="title">Version</span> </span>{</div><div class="line">	String value();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// @Audit</span></div><div class="line"><span class="annotation">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class="line"><span class="annotation">@Target</span>({ ElementType.METHOD })</div><div class="line"><span class="keyword">public</span> @<span class="class"><span class="keyword">interface</span> <span class="title">Audit</span> </span>{</div><div class="line">	String value();</div><div class="line">}</div></pre></td></tr></table></figure>

<p>And now, you will need to update you web.xml to include ResourceFilterFactory </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">servlet</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">servlet-name</span>&gt;</span>REST<span class="tag">&lt;/<span class="title">servlet-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">servlet-class</span>&gt;</span></div><div class="line">        com.sun.jersey.spi.spring.container.servlet.SpringServlet</div><div class="line">    <span class="tag">&lt;/<span class="title">servlet-class</span>&gt;</span></div><div class="line">    ...</div><div class="line">    <span class="comment">&lt;!-- Our resource filter for tangential concerns (security, logging, version etc.) --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">init-param</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">param-name</span>&gt;</span>com.sun.jersey.spi.container.ResourceFilters<span class="tag">&lt;/<span class="title">param-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">param-value</span>&gt;</span>com.strumsoft.api.ResourceFilterFactory<span class="tag">&lt;/<span class="title">param-value</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">init-param</span>&gt;</span></div><div class="line">    ...</div><div class="line"><span class="tag">&lt;/<span class="title">servlet</span>&gt;</span></div></pre></td></tr></table></figure>

<p>That’s it. All configuration is done. Now, you just need to annotate you Resources. Let’s see how. </p>
<p>Say, you have a BookResource which exposes APIs to create/edit/list books. And you want<br>1. “Editor/Contributor” to be able to create a book, (<strong>@RolesAllowed({ “Editor”, “Contributor” })</strong>)<br>2. Only “Editor” to be able to edit a book, (<strong>@RolesAllowed({ “Editor” })</strong>)<br>3. While, anyone can see all the books. (<strong>@PermitAll</strong>)</p>
<p>Also, let’s say editing a book was released in API 1.3, so any client still using older APIs should not be able to update (<strong>@Version(“&gt;1.3”)</strong>) an existing book. (Assuming you implemented VersionFilter properly)</p>
<p>Additionally, create or edit book should be audited with respective notes “create-book” and “edit-book” given your AuditFilter is in place. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.strumsoft.api;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.ws.rs.FormParam;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.GET;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.POST;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.PUT;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.Produces;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.core.Context;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.core.MediaType;</div><div class="line"><span class="keyword">import</span> javax.ws.rs.core.SecurityContext;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.flockthere.api.audit.Audit;</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> * Book Resource</div><div class="line"> * </div><div class="line"> *<span class="javadoctag"> @Path</span>(&quot;/book/&quot;)</div><div class="line"> *<span class="javadoctag"> @author</span> &quot;Animesh Kumar &lt;animesh@strumsoft.com&gt;&quot;</div><div class="line"> * </div><div class="line"> */</div><div class="line"><span class="annotation">@Produces</span>({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookResource</span> </span>{</div><div class="line"></div><div class="line">	<span class="comment">// Only Editor and Contributor can create a book entry</span></div><div class="line">	<span class="annotation">@javax</span>.annotation.security.RolesAllowed({ &quot;Editor&quot;, &quot;Contributor&quot; })</div><div class="line">	<span class="annotation">@Audit</span>(&quot;create-book&quot;)  <span class="comment">// Audit</span></div><div class="line">	<span class="annotation">@POST</span></div><div class="line">	<span class="keyword">public</span> Book <span class="title">createBook</span>(@Context SecurityContext sc, @<span class="title">FormParam</span>(&quot;title&quot;) String title,</div><div class="line">			<span class="annotation">@FormParam</span>(&quot;author&quot;) String author, <span class="annotation">@FormParam</span>(&quot;publisher&quot;) String publisher,</div><div class="line">			<span class="annotation">@FormParam</span>(&quot;isbn&quot;) String isbn, <span class="annotation">@FormParam</span>(&quot;edition&quot;) String edition);</div><div class="line"></div><div class="line">	<span class="comment">// Only Editor can edit an existing book entry</span></div><div class="line">	<span class="annotation">@javax</span>.annotation.security.RolesAllowed({ &quot;Editor&quot; })</div><div class="line">	<span class="annotation">@Audit</span>(&quot;edit-book&quot;)   <span class="comment">// Audit</span></div><div class="line">	<span class="annotation">@Version</span>(&quot;&gt;<span class="number">1.3</span>&quot;)  <span class="comment">// Available only on API version 1.3 onwards</span></div><div class="line">	<span class="annotation">@PUT</span></div><div class="line">	<span class="keyword">public</span> Book <span class="title">editBook</span>(@Context SecurityContext sc, @<span class="title">FormParam</span>(&quot;title&quot;) String title,</div><div class="line">			<span class="annotation">@FormParam</span>(&quot;author&quot;) String author, <span class="annotation">@FormParam</span>(&quot;publisher&quot;) String publisher,</div><div class="line">			<span class="annotation">@FormParam</span>(&quot;isbn&quot;) String isbn, <span class="annotation">@FormParam</span>(&quot;edition&quot;) String edition);</div><div class="line"></div><div class="line">	<span class="comment">// Anyone can see these books</span></div><div class="line">	<span class="annotation">@javax</span>.annotation.security.PermitAll</div><div class="line">	<span class="annotation">@GET</span></div><div class="line">	<span class="keyword">public</span> Book <span class="title">listBooks</span>();</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<p>And at last, you will need to add <a href="http://jcp.org/en/jsr/detail?id=250" target="_blank" rel="external">jsr250-api</a> to your project dependencies which defines javax.annotation.security.* annotations. </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- securty tags: javax.annotation.security.* (@RolesAllowed, @PermitAll, @DenyAll etc.) --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>jsr250-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></div></pre></td></tr></table></figure>

<p>Chill. :)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://47billion.com/blog/2012/03/02/securing-versioning-and-auditing-rest-jax-rs-jersey-apis/" data-id="4y8xd6oiessm1tft" class="article-share-link">Share</a>
      
        <a href="http://47billion.com/blog/2012/03/02/securing-versioning-and-auditing-rest-jax-rs-jersey-apis/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JAX-RS/">JAX-RS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Jersey/">Jersey</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/REST/">REST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Security/">Security</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/jsr250/">jsr250</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
        47Billion &copy; 2015
    </div>
  </div>
</footer>
    </div>
    
<script>
  var disqus_shortname = '47Billion';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/blog/js/jquery.min.js" type="text/javascript"></script>

<script src="/blog/js/jquery.scrollLoading.js" type="text/javascript"></script>



  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/blog/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/blog/js/script.js" type="text/javascript"></script>

<script src="/blog/js/jquery.slicknav.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function(){
        $('#sidebar').slicknav();
    });
</script>
  </div>
</body>
</html>